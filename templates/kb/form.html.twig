{% extends 'base.html.twig' %}

{% block title %}{{ page_title|trans }}{% endblock %}

{% block body %}
    <div style="margin-bottom: 1rem;">
        <a href="{{ path('app_kb_manage') }}" style="color: #3B82F6; text-decoration: none;">
            <i class="fa-solid fa-arrow-left"></i> {{ 'Back to Manage'|trans }}
        </a>
    </div>

    <div class="card" style="max-width: 800px; margin: 0 auto;">
        <div class="card-header" style="margin-bottom: 1.5rem;">
            <h3 class="card-title">{{ page_title|trans }}</h3>
        </div>

        <form method="post" action="{{ article and article.id ? path('app_kb_edit', {id: article.id}) : path('app_kb_new') }}">
            <div style="margin-bottom: 1.5rem;">
                <label for="title" style="display: block; font-weight: 500; margin-bottom: 0.5rem; color: #374151;">{{ 'Title'|trans }}</label>
                <input type="text" id="title" name="title" value="{{ article ? article.title : '' }}" required class="input" style="width: 100%;">
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem;">
                <div>
                    <label for="category" style="display: block; font-weight: 500; margin-bottom: 0.5rem; color: #374151;">{{ 'Category'|trans }}</label>
                    <select id="category" name="category" class="select" style="width: 100%;">
                        <option value="">{{ 'Select Category'|trans }}</option>
                        {% for category in categories %}
                            <option value="{{ category.id }}" {% if article and article.category and article.category.id == category.id %}selected{% endif %}>
                                {{ category.label }}
                            </option>
                        {% endfor %}
                    </select>
                </div>
                
                <div style="display: flex; align-items: center; padding-top: 1.5rem;">
                    <label style="display: flex; align-items: center; cursor: pointer;">
                        <input type="checkbox" name="isPublished" value="1" {% if article is null or article.isPublished %}checked{% endif %} style="width: 1rem; height: 1rem; margin-right: 0.5rem;">
                        <span style="color: #374151;">{{ 'Publish immediately'|trans }}</span>
                    </label>
                </div>
            </div>

            <div style="margin-bottom: 2rem;">
                <label for="content" style="display: block; font-weight: 500; margin-bottom: 0.5rem; color: #374151;">{{ 'Content'|trans }}</label>
                <textarea id="content" name="content" rows="15" required class="input" style="width: 100%; font-family: inherit;">{{ article ? article.content : '' }}</textarea>
                <p style="margin-top: 0.5rem; font-size: 0.875rem; color: #6B7280;">{{ 'You can use basic HTML tags for formatting if needed.'|trans }}</p>
            </div>

            <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                <a href="{{ path('app_kb_manage') }}" class="btn btn-secondary">{{ 'Cancel'|trans }}</a>
                <button type="submit" class="btn btn-primary">{{ 'Save Article'|trans }}</button>
            </div>
        </form>
    </div>
{% endblock %}
