<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Genesys Helpdesk | Tickets</title>
    <link rel="stylesheet" href="{{ asset('css/style.css') }}">
</head>
<body>

    <div class="app-container">

        {{ include('partials/_sidebar.html.twig') }}

        <main class="main-content">
            <div class="card">
                <div class="card-header" style="margin-bottom: 1rem; display: flex; justify-content: space-between; align-items: center;">
                    <h3 class="card-title" style="font-size: 1.25rem;">Recent Tickets</h3>
                    <a href="{{ path('app_ticket_create') }}" style="font-size: 0.875rem; color: #3B82F6; text-decoration: none; font-weight: 600;">+ New Ticket</a>
                </div>
                
                <div class="table-container">
                    <table class="styled-table">
                        <thead>
                            <tr>
                                <th>Ticket ID</th>
                                <th>Subject</th>
                                <th>Assigned To</th>
                                <th>Date</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for ticket in tickets %}
                                {% set statusLabel = ticket.status_label ?? 'Open' %}
                                {% set statusClass = statusLabel|lower in ['resolved', 'closed'] ? 'status-closed' : 'status-open' %}
                                <tr>
                                    <td>#T-{{ ticket.id }}</td>
                                    <td>{{ ticket.title }}</td>
                                    <td>{{ ticket.assignee_name ?? 'Unassigned' }}</td>
                                    <td>{{ ticket.created_at|date('M d, Y H:i') }}</td>
                                    <td><span class="status-badge {{ statusClass }}">{{ statusLabel }}</span></td>
                                </tr>
                            {% else %}
                                <tr>
                                    <td colspan="5">No tickets available.</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

</body>
</html>
